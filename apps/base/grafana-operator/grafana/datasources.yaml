apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDatasource
metadata:
  name: victoria-metrics
spec:
  datasource:
    access: proxy
    type: prometheus
    jsonData:
      timeInterval: 5s
      tlsSkipVerify: true
    name: VictoriaMetrics
    url: http://vmks-vm-select:8481/select/0/prometheus
  instanceSelector:
    matchLabels:
      dashboards: homelab
---
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDatasource
metadata:
  name: github
spec:
  valuesFrom:
    - targetPath: "jsonData.appId"
      valueFrom:
        secretKeyRef:
          name: grafana-github-datasource
          key: app_id
    - targetPath: "jsonData.installationId"
      valueFrom:
        secretKeyRef:
          name: grafana-github-datasource
          key: installation_id
    - targetPath: "secureJsonData.privateKey"
      valueFrom:
        secretKeyRef:
          name: grafana-github-datasource
          key: private_key
  datasource:
    access: proxy
    type: &datasource grafana-github-datasource
    jsonData:
      selectedAuthType: github-app
      appId: "${app_id}"
      installationId: "${installation_id}"
    secureJsonData:
      privateKey: "${private_key}"
    name: GitHub
  instanceSelector:
    matchLabels:
      dashboards: homelab
  plugins:
    - name: *datasource
      version: 2.3.0
---

